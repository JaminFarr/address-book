(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{154:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(16),c=a.n(l),o=(a(72),a(63)),s=a.n(o),u=a(8),i=a(12),d=a.n(i),m=a(9),E=a.n(m),p=a(14),f=a.n(p),v=a(64),b=a(18),h=a.n(b);var g="initStore",O="addAddress",y="updateAddress",j="removeAddress",N=function(e,t){switch(t.type){case g:return t.payload;case O:return[].concat(Object(v.a)(e),[t.payload]);case y:return e.map(function(e){return e.email===t.payload.email?t.payload.address:e});case j:return e.filter(function(e){return e.email!==t.payload});default:return e}},w=Object(n.createContext)(),C=function(e){var t=e.children,a=Object(n.useReducer)(N,[]),l=Object(u.a)(a,2),c=l[0],o=l[1],s=Object(n.useMemo)(function(){return{add:function(e){o({type:O,payload:e})},update:function(e,t){o({type:y,payload:{email:e,address:t}})},remove:function(e){o({type:j,payload:e})}}},[o]),i=function(e,t){var a=Object(n.useState)(function(){try{var a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(n){return console.log(n),t}}),r=Object(u.a)(a,2),l=r[0],c=r[1];return[l,function(t){try{var a=t instanceof Function?t(l):t;c(a),window.localStorage.setItem(e,JSON.stringify(a))}catch(n){console.log(n)}}]}("benf-address-book","NO_LOCALSTORE"),d=Object(u.a)(i,2),m=d[0],E=d[1];Object(n.useEffect)(function(){if("NO_LOCALSTORE"===m)h.a.get("/data/entries.json").then(function(e){var t=e.data;return o({type:g,payload:t})});else{var e=new Set;o({type:g,payload:m.filter(function(t){var a=t.email,n=e.has(a);return e.add(a),!n})})}},[]),Object(n.useEffect)(function(){E(c)},[c]);var p={addresses:c,actions:s};return r.a.createElement(w.Provider,{value:p},t)},x=a(65),S=a(6),k=function(e){var t=e.title,a=e.value;return r.a.createElement("div",{className:"mt-2 mb-4"},r.a.createElement("p",{className:"h3"},t,":"),r.a.createElement("p",null,"string"===typeof a?a.split(/\r\n|\n|\r/g).map(function(e,t){return r.a.createElement(n.Fragment,{key:t},e,r.a.createElement("br",null))}):r.a.createElement(n.Fragment,null,a,r.a.createElement("br",null))))},L=a(59),A=a.n(L),T=a(60),I=a.n(T),F=function(e,t,a){var n=String.fromCharCode(97+(e+t+a)%3);return"https://".concat(n,".tile.openstreetmap.org/").concat(a,"/").concat(e,"/").concat(t,".png")},P=function(e){var t=e.location,a=t.latitude,n=t.longitude;return r.a.createElement(A.a,{center:[a,n],defaultZoom:10,height:320,zoomSnap:!1,provider:F},r.a.createElement(I.a,{anchor:[a,n]}))},R=function(e){var t=e.className,a=Object(x.a)(e,["className"]);return r.a.createElement("button",Object.assign({type:"button",className:"close ".concat(t),"aria-label":"Close"},a),r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))},B=function(e){var t=e.address,a=e.clearSelection,n=e.remove,l=e.edit,c=t.name,o=t.email,s=t.tel,u=t.address1,i=t.address2,m=t.town,p=t.county,v=t.postcode,b=t.longitude,h=t.latitude,g=[u,i,m,p,v].filter(Boolean).join("\n"),O=b&&h&&{longitude:b,latitude:h};return r.a.createElement("div",null,r.a.createElement(f.a,null,r.a.createElement(E.a,null,r.a.createElement("h1",null,c)),r.a.createElement(E.a,{xs:1,className:"text-right"},r.a.createElement(R,{onClick:a,className:"ml-2"}))),r.a.createElement(f.a,null,r.a.createElement(E.a,null,r.a.createElement(k,{title:"Email",value:o}),r.a.createElement(k,{title:"Tel",value:s})),r.a.createElement(E.a,null,r.a.createElement(k,{title:"Address",value:g}))),O&&r.a.createElement("div",{className:"mb-3"},r.a.createElement(P,{location:O})),r.a.createElement("div",{className:"text-right"},r.a.createElement(d.a,{variant:"primary",className:"mr-2",onClick:function(){return l&&l(t)}},"Edit"),r.a.createElement(d.a,{variant:"danger",onClick:function(){return n&&n(t)}},"Delete")))};B.propsTypes={address:S.object.isRequired,remove:S.func,edit:S.func,clearSelection:S.func};var G=B,_=a(22),D=a(2),H=a.n(D),J=a(19),z=a.n(J),U=a(62),V=a.n(U),W=a(23),q=a(32),M=a.n(q),Y=a(61),Z=h.a.CancelToken,$=function(e){var t=e.setPostcode,a=Object(n.useState)(""),l=Object(u.a)(a,2),c=l[0],o=l[1],s=function(e){var t=Object(n.useState)(null),a=Object(u.a)(t,2),r=a[0],l=a[1],c=Object(n.useState)(null),o=Object(u.a)(c,2),s=o[0],i=o[1];return Object(n.useEffect)(function(){if(!e||e.length<6||e.length>10)return i(!1),void l(null);i(!0);var t=Z.source();return function(){var a=Object(Y.a)(M.a.mark(function a(){var n;return M.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,h()("https://api.postcodes.io/postcodes/".concat(e),{cancelToken:t.token});case 3:n=a.sent,l(n.data),i(!1),a.next=14;break;case 8:if(a.prev=8,a.t0=a.catch(0),!h.a.isCancel(a.t0)){a.next=12;break}return a.abrupt("return");case 12:i(!1),a.t0.response&&404===a.t0.response.status?l("NOT FOUND"):l("ERROR");case 14:case"end":return a.stop()}},a,null,[[0,8]])}));return function(){return a.apply(this,arguments)}}()(),function(){t.cancel()}},[e]),{isLoading:s,result:r&&r.result,isNotFound:"NOT FOUND"===r,hasError:"ERROR"===r}}(function(e,t){var a=Object(n.useState)(null),r=Object(u.a)(a,2),l=r[0],c=r[1];return Object(n.useEffect)(function(){var a=setTimeout(function(){c(e)},t);return function(){return clearTimeout(a)}},[e]),l}(c,400)),i=s.result,m=s.isLoading,p=s.isNotFound,v=s.hasError,b=i&&{town:i.admin_district||i.primary_care_trust,county:i.admin_county||i.region||i.parliamentary_constituency,postcode:i.postcode,latitude:i.latitude,longitude:i.longitude};return r.a.createElement("div",null,r.a.createElement(H.a.Group,{controlId:"postcodeLookup"},r.a.createElement(H.a.Label,{className:"h3"},"Postcode Search:"),r.a.createElement(H.a.Control,{type:"text",name:"postcode-search",placeholder:"Lookup Postcode",value:c,onChange:function(e){var t=e.target.value;return o(t)}}),r.a.createElement(H.a.Text,null,m&&r.a.createElement("span",null,"Loading"),p&&r.a.createElement("span",{className:"text-warning"},"Postcode could not be found"),v&&r.a.createElement("span",{className:"text-warning"},"There was an error looking up the postcode"),r.a.createElement("span",{className:"text-white"},"!"))),r.a.createElement(f.a,null,r.a.createElement(E.a,null,r.a.createElement(k,{title:"Town",value:b&&b.town})),r.a.createElement(E.a,null,r.a.createElement(k,{title:"County",value:b&&b.county}))),r.a.createElement("div",{className:"text-right"},r.a.createElement(d.a,{disabled:!b,onClick:function(){return t(b)}},"Set Postcode")))},K=function(e){var t=e.bindField,a=e.clearPostcode;return r.a.createElement("div",null,r.a.createElement(H.a.Group,{controlId:"addressLine1"},r.a.createElement(H.a.Label,{className:"h3"},"Address:"),r.a.createElement(H.a.Control,Object.assign({type:"text",name:"line1",placeholder:"Address line 1"},t("address1")))),r.a.createElement(H.a.Group,{controlId:"addressLine2"},r.a.createElement(H.a.Control,Object.assign({type:"text",name:"line2",placeholder:"Address line 2"},t("address2")))),r.a.createElement(H.a.Group,{controlId:"addressTown"},r.a.createElement(H.a.Label,{className:"h4"},"Town:"),r.a.createElement(H.a.Control,Object.assign({type:"text",name:"town",placeholder:"Address town"},t("town")))),r.a.createElement(H.a.Group,{controlId:"addressCounty"},r.a.createElement(H.a.Label,{className:"h4"},"County:"),r.a.createElement(H.a.Control,Object.assign({type:"text",name:"county",placeholder:"Address town"},t("county")))),r.a.createElement(H.a.Group,{controlId:"addressCounty"},r.a.createElement(H.a.Label,{className:"h4"},"Postcode:"," ",r.a.createElement(d.a,{size:"sm",variant:"secondary",onClick:a},"Clear")),r.a.createElement(H.a.Control,Object.assign({type:"text",name:"county",placeholder:"Address town",disabled:!0},t("postcode")))))},Q=function(e){var t=e.address,a=void 0===t?{name:null,email:null,tel:null,address1:null,address2:null,town:null,county:null,postcode:null,longitude:null,latitude:null}:t,l=e.storeAddress,c=e.onClose,o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(n.useState)(e),a=Object(u.a)(t,2),r=a[0],l=a[1],c=function(e,t){return l(function(a){return Object(_.a)({},a,Object(W.a)({},e,t))})};return{formState:r,setFormState:l,setField:c,bindField:function(e){return{value:r[e],onChange:function(t){return c(e,(a=t).target&&void 0!==a.target.value?a.target.value:a);var a}}}}}(a),s=o.formState,i=o.setFormState,m=o.setField,p=o.bindField,v=Object(n.useState)(!0),b=Object(u.a)(v,2),h=b[0],g=b[1],O=function(e,t){var a=Object(n.useContext)(w).addresses;return e!==t&&Boolean(a.find(function(t){return t.email===e}))}(s.email,a.email),y=Boolean(s.postcode),j=y&&s.name&&s.email&&!O;return r.a.createElement(z.a,{show:h,size:"lg",onHide:function(){return g(!1)},onExited:c},r.a.createElement(z.a.Header,{closeButton:!0},r.a.createElement(z.a.Title,null,a.email?"Edit Address":"Add Address")),r.a.createElement(z.a.Body,null,r.a.createElement(H.a,null,r.a.createElement(f.a,{style:{minHeight:"26rem"}},r.a.createElement(E.a,null,r.a.createElement(H.a.Group,{controlId:"addressName"},r.a.createElement(H.a.Label,{className:"h3"},"Name:"),r.a.createElement(H.a.Control,Object.assign({type:"text",name:"name",placeholder:"Enter full name"},p("name")))),r.a.createElement(H.a.Group,{controlId:"addressEmail"},r.a.createElement(H.a.Label,{className:"h3"},"Email:"),r.a.createElement(H.a.Control,Object.assign({type:"email",name:"email",placeholder:"Enter email"},p("email"))),O?r.a.createElement(V.a,{variant:"danger"},"Duplicate email"):null),r.a.createElement(H.a.Group,{controlId:"addressTel"},r.a.createElement(H.a.Label,{className:"h3"},"Tel:"),r.a.createElement(H.a.Control,Object.assign({type:"text",name:"telephone",placeholder:"Enter telephone number"},p("tel"))))),r.a.createElement(E.a,null,y?r.a.createElement(K,{bindField:p,clearPostcode:function(){return m("postcode",null)}}):r.a.createElement($,{setPostcode:function(e){return i(Object(_.a)({},s,e))}}))),r.a.createElement("div",{className:"text-right"}))),r.a.createElement(z.a.Footer,null,r.a.createElement(d.a,{disabled:!j,onClick:function(){return l(s)}},"Save")))},X=a(33),ee=a.n(X),te=function(e){var t=e.active,a=e.children,l=Object(n.createRef)();return Object(n.useEffect)(function(){t&&"function"===typeof l.current.scrollIntoViewIfNeeded&&l.current.scrollIntoViewIfNeeded()},[t]),r.a.createElement("div",{ref:l},a)},ae=function(e){var t=e.addresses,a=e.isSelected,n=e.onClick;return r.a.createElement(ee.a,{style:{maxHeight:"600px",overflowY:"auto",borderTop:"1px solid rgba(0, 0, 0, 0.125)",borderBottom:"1px solid rgba(0, 0, 0, 0.125)"}},t.map(function(e){var t=a(e);return r.a.createElement(ee.a.Item,{key:e.email,active:t,action:Boolean(n),onClick:function(){return n(e)}},r.a.createElement(te,{active:t},e.name))}))},ne=a(24),re=a.n(ne),le=a(31),ce=a.n(le),oe=a(34),se=function(e){var t=e.value,a=e.onChange;return r.a.createElement("div",null,r.a.createElement(re.a,{className:"my-3"},r.a.createElement(ce.a,{type:"search",placeholder:"search",value:t,onChange:a&&function(e){var t=e.target;return a(t.value)}}),r.a.createElement(re.a.Append,null,r.a.createElement(re.a.Text,null,r.a.createElement(oe.b,{icon:oe.a})))))},ue=function(){var e=Object(n.useContext)(w),t=e.addresses,a=e.actions,l=Object(n.useState)(null),c=Object(u.a)(l,2),o=c[0],s=c[1],i=Object(n.useState)(""),m=Object(u.a)(i,2),p=m[0],v=m[1],b=Object(n.useState)(null),h=Object(u.a)(b,2),g=h[0],O=h[1],y=t.slice().sort(function(e,t){return e.name===t.name?0:e.name>t.name?1:-1}).filter(function(e){return e.name.toLowerCase().includes(p.toLowerCase())});return r.a.createElement("div",null,r.a.createElement(f.a,{className:"m-4"},r.a.createElement(E.a,{md:4,xs:8},r.a.createElement(se,{className:o?"d-none d-md-block":"",value:p,onChange:v})),r.a.createElement(E.a,{className:"text-right"},r.a.createElement(d.a,{className:"my-3",onClick:function(){return O({name:null,email:null,tel:null,address1:null,address2:null,town:null,county:null,postcode:null,longitude:null,latitude:null})}},"Add Address"))),r.a.createElement(f.a,{className:"m-4"},r.a.createElement(E.a,{md:4,className:o?"d-none d-md-block":""},r.a.createElement(ae,{addresses:y,isSelected:function(e){return e===o},onClick:s})),r.a.createElement(E.a,null,o?r.a.createElement(G,{address:o,clearSelection:function(){return s(null)},edit:O,remove:function(e){a.remove(e.email),o===e&&s(null)}}):r.a.createElement("div",{className:"d-none d-md-block"},r.a.createElement("p",null,"Please select an address")))),g&&r.a.createElement(Q,{address:g,onClose:function(){return O(null)},storeAddress:function(e){var t=g&&g.email;t?a.update(t,e):a.add(e),O(null),s(e)}}))},ie=function(){return r.a.createElement(C,null,r.a.createElement(s.a,null,r.a.createElement(ue,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(ie,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},66:function(e,t,a){e.exports=a(154)},72:function(e,t,a){}},[[66,1,2]]]);
//# sourceMappingURL=main.aaa6fd15.chunk.js.map